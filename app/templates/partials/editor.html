{% extends "base.html" %}

{% block scripts %}
    <script src="../../static/js/editor.js" type="text/javascript"></script>
    <script src="../../static/js/src-min/ace.js" type="text/javascript"></script>
    <script src="http://www.skulpt.org/static/skulpt.min.js" type="text/javascript"></script>
    <script src="http://www.skulpt.org/static/skulpt-stdlib.js" type="text/javascript"></script>
{% endblock %}

{% block stylesheets %}
    <style type="text/css" media="screen">
        #code_editor {
            width: 500px;
            height: 414px;
        }
        #editor_out {
            width: 200px;
            height: 200px;
            background-color: darkgray;
            white-space: pre-wrap;
        }
        #editor_canvas {
            width: 200px;
            height: 200px;
            background-color: lightgray;
        }
    </style>
{% endblock %}

{% block contents %}
    <h1>Assignment: {{ assignment.title }}</h1>
    <p>Description: {{ assignment.desc }}</p>
    <table>
        <tr valign="top">
            {% if g.user.has_solved(assignment) %}
                <td><pre id="code_editor">{{ user_soln }}</pre></td>
            {% else %}
                <td><pre id="code_editor">print "All of your code should go here!"</pre></td>
            {% endif %}
            <td>
                <pre id="editor_out"></pre>
                <pre id="editor_canvas"></pre>
            </td>
        </tr>
    </table>
    <script>
        // enable Ace editor
        var editor = ace.edit("code_editor");
        editor.setTheme("ace/theme/monokai");
        editor.getSession().setMode("ace/mode/python");
    </script>
    <input type="button" onclick="skulpt_run(null, 'editor_out', 'editor_canvas')" value="Run" />
    <input type="button"
           onclick="get_test({{ assignment.id }}, {{ g.user.id }})"
           value="Submit" />
    <!-- test_out: Used to collect printed test output. TODO: eliminate this. -->
    <pre id="test_out" style="display: none"></pre>
    <div>
        <div id="loading" style="display: none">
            Loading...
        </div>
        <div id="success" class="alert alert-success" style="display: none">
            <strong>Success!</strong> Go on to the next assignment.
        </div>
        <div id="fail" class="alert alert-danger" style="display: none">
            <strong>Oh, snap.</strong> Seems your code doesn't work. Fix up any bugs and try submitting again.
        </div>
    </div>
{% endblock %}